<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Business Clicker üí∞</title>
    <style>
        /* CSS pour l'optimisation mobile et le style */
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f7f6;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            text-align: center;
        }

        #game-container {
            width: 100%;
            max-width: 450px; /* Taille maximale pour simuler un t√©l√©phone */
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            box-sizing: border-box;
        }

        h1 {
            color: #2a9d8f;
            margin-bottom: 10px;
            font-size: 1.8em;
        }

        #money-display {
            font-size: 2.5em;
            font-weight: bold;
            color: #e76f51;
            margin: 20px 0;
            padding: 10px;
            border: 2px solid #e76f51;
            border-radius: 8px;
            background-color: #fff3e0;
        }

        #click-button {
            background-color: #2a9d8f;
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 1.5em;
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 5px #264653;
            margin-bottom: 30px;
            transition: transform 0.1s, box-shadow 0.1s;
            width: 80%;
            height: 120px;
        }

        #click-button:active {
            box-shadow: 0 2px #264653;
            transform: translateY(3px);
        }

        #upgrade-list {
            list-style: none;
            padding: 0;
            margin-top: 20px;
            width: 100%;
        }

        .upgrade-item {
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            margin-bottom: 10px;
            padding: 15px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-align: left;
        }

        .upgrade-item button {
            background-color: #f4a261;
            color: white;
            border: none;
            padding: 10px 15px;
            cursor: pointer;
            border-radius: 5px;
            font-weight: bold;
            transition: background-color 0.2s;
        }

        .upgrade-item button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        .upgrade-info {
            flex-grow: 1;
        }

        .upgrade-info strong {
            display: block;
            font-size: 1.1em;
            color: #264653;
        }
        
        #save-load-buttons {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }
        
        #save-load-buttons button {
            padding: 10px 15px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        
        #save-button {
            background-color: #4CAF50;
            color: white;
        }
        
        #reset-button {
            background-color: #f44336;
            color: white;
        }
    </style>
</head>
<body>

<div id="game-container">
    <h1>Business Empire üí∞</h1>
    
    <div id="money-display">$ <span id="money">0.00</span></div>
    
    <button id="click-button">
        Faire un Deal ! <br> (+ $<span id="click-value">1</span>)
    </button>
    
    <div id="per-sec-display">
        Gains/seconde: $<span id="per-sec">0.00</span>
    </div>

    <h2>Am√©liorations (Business)</h2>
    <ul id="upgrade-list">
        </ul>
    
    <div id="save-load-buttons">
        <button id="save-button" onclick="saveGame()">Sauvegarder</button>
        <button id="reset-button" onclick="resetGame()">Recommencer</button>
    </div>
    
</div>

<script>
    // --- VARIABLES GLOBALES ---
    let money = 0;
    let clickValue = 1;
    let gameInterval;

    const upgrades = [
        { id: 'lemonade', name: 'Stand de Limonade', basePrice: 15, basePerSec: 0.1, count: 0 },
        { id: 'newspaper', name: 'Livraison de Journaux', basePrice: 100, basePerSec: 1, count: 0 },
        { id: 'carwash', name: 'Lavage de Voitures', basePrice: 1100, basePerSec: 8, count: 0 },
        { id: 'pizzashop', name: 'Pizzeria', basePrice: 12000, basePerSec: 47, count: 0 },
        { id: 'startup', name: 'Startup Tech', basePrice: 130000, basePerSec: 260, count: 0 }
    ];

    // --- FONCTIONS DU JEU ---

    // 1. Mise √† jour de l'affichage de l'argent
    function updateDisplay() {
        document.getElementById('money').textContent = money.toFixed(2);
        document.getElementById('click-value').textContent = clickValue.toFixed(2);
        
        const perSecValue = calculatePerSecond();
        document.getElementById('per-sec').textContent = perSecValue.toFixed(2);
    }

    // 2. Calcul des gains par seconde
    function calculatePerSecond() {
        return upgrades.reduce((sum, item) => {
            const multiplier = Math.pow(1.15, item.count); // Prix augmente de 15% par achat
            return sum + (item.basePerSec * item.count * multiplier); 
        }, 0);
    }
    
    // 3. Le clic principal
    function doClick() {
        money += clickValue;
        updateDisplay();
    }

    // 4. G√©n√©ration du HTML des am√©liorations
    function renderUpgrades() {
        const list = document.getElementById('upgrade-list');
        list.innerHTML = ''; 

        upgrades.forEach(item => {
            const price = calculatePrice(item);
            const perSec = calculateItemPerSecond(item);

            const li = document.createElement('li');
            li.className = 'upgrade-item';
            li.innerHTML = `
                <div class="upgrade-info">
                    <strong>${item.name} (x${item.count})</strong>
                    <span>G√©n√®re: $${perSec.toFixed(2)}/s</span>
                    <span>Prochain prix: $${price.toFixed(2)}</span>
                </div>
                <button onclick="buyUpgrade('${item.id}')" id="btn-${item.id}">
                    Acheter
                </button>
            `;
            list.appendChild(li);
            
            // Mettre √† jour l'√©tat du bouton
            updateUpgradeButton(item.id, price);
        });
    }
    
    // 5. Calcul du prix d'une am√©lioration
    function calculatePrice(item) {
        return item.basePrice * Math.pow(1.15, item.count);
    }
    
    // 6. Calcul du gain/sec total pour cet item
    function calculateItemPerSecond(item) {
        return item.basePerSec * item.count;
    }

    // 7. Achat d'une am√©lioration
    function buyUpgrade(id) {
        const item = upgrades.find(up => up.id === id);
        if (!item) return;

        const price = calculatePrice(item);

        if (money >= price) {
            money -= price;
            item.count++;
            
            // Mettre √† jour le gain par clic si c'est la limonade (premier item)
            if (item.id === 'lemonade') {
                clickValue += 0.5;
            }
            
            renderUpgrades();
            updateDisplay();
            saveGame(); // Sauvegarder apr√®s l'achat
        } else {
            alert("Pas assez d'argent !");
        }
    }
    
    // 8. Mise √† jour des boutons 'Acheter' (disponibilit√©)
    function updateUpgradeButton(id, price) {
        const button = document.getElementById(`btn-${id}`);
        if (button) {
            button.disabled = money < price;
        }
    }

    // 9. Boucle de jeu (tick)
    function gameLoop() {
        const perSec = calculatePerSecond();
        money += perSec / 10; // Ajout 10 fois par seconde (100ms)
        
        // Mettre √† jour l'affichage et les boutons
        updateDisplay();
        upgrades.forEach(item => {
            const price = calculatePrice(item);
            updateUpgradeButton(item.id, price);
        });
    }

    // --- FONCTIONS DE SAUVEGARDE (Local Storage) ---

    function saveGame() {
        const saveData = {
            money: money,
            clickValue: clickValue,
            upgrades: upgrades.map(item => ({
                id: item.id,
                count: item.count
            }))
        };
        // Sauvegarde au format JSON dans le stockage local du navigateur
        localStorage.setItem('businessClickerSave', JSON.stringify(saveData));
        console.log("Jeu sauvegard√© !");
    }

    function loadGame() {
        const savedData = localStorage.getItem('businessClickerSave');
        if (savedData) {
            const data = JSON.parse(savedData);
            
            money = data.money || 0;
            clickValue = data.clickValue || 1;
            
            // Mise √† jour des compteurs des am√©liorations
            if (data.upgrades) {
                data.upgrades.forEach(savedItem => {
                    const gameItem = upgrades.find(up => up.id === savedItem.id);
                    if (gameItem) {
                        gameItem.count = savedItem.count;
                    }
                });
            }
            console.log("Jeu charg√© !");
        } else {
            console.log("Aucune sauvegarde trouv√©e.");
        }
    }
    
    function resetGame() {
        if (confirm("√ätes-vous s√ªr de vouloir tout recommencer ? Votre progression sera perdue.")) {
            localStorage.removeItem('businessClickerSave');
            money = 0;
            clickValue = 1;
            upgrades.forEach(item => { item.count = 0; });
            initGame();
            alert("Jeu r√©initialis√©.");
        }
    }

    // --- INITIALISATION ---

    function initGame() {
        loadGame(); // Essayer de charger la sauvegarde au d√©marrage
        
        // Attacher l'√©v√©nement de clic
        document.getElementById('click-button').addEventListener('click', doClick);
        
        // D√©marrer la boucle de jeu (toutes les 100ms pour un calcul par seconde pr√©cis)
        if (gameInterval) clearInterval(gameInterval); // S'assurer qu'il n'y en a qu'un
        gameInterval = setInterval(gameLoop, 100); 
        
        // Affichage initial
        renderUpgrades();
        updateDisplay();
    }

    // D√©marrer le jeu quand la page est charg√©e
    window.onload = initGame;
    
</script>

</body>
</html>
